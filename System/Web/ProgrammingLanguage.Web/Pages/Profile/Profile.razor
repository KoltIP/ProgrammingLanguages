@page "/profile"
@layout MainLayout

@using ProgrammingLanguage.Web.Pages.Profile.Models
@using System.ComponentModel.DataAnnotations
@using ProgrammingLanguage.Web.Pages.Profile.Services

@inject IProfileService profileService
@inject IDialogService DialogService

@attribute [Authorize]

<MudGrid Justify="Justify.Center" Class="pa-10">
    <MudItem xs="12" sm="7">
        <MudPaper Class="pa-4">
            <MudText Typo="Typo.h4" GutterBottom="true" Class="mb-3">Profile <MudProgressCircular Color="Color.Primary" Size="Size.Medium" /></MudText>            
            <MudText Align="Align.Left"><b>Your Name:</b> @username 
                <MudTooltip Text="Edit username">
                    <MudIconButton Icon="@Icons.Material.Filled.Edit" 
                        Variant="Variant.Outlined" 
                        Color="Color.Primary" 
                        Size="Size.Medium" 
                        />
                </MudTooltip>
            </MudText> 
            <MudText Align="Align.Left"><b>Youe Email:</b> @email
                <MudTooltip Text="Edit email">
                    <MudIconButton Icon="@Icons.Material.Filled.Edit" 
                        Variant="Variant.Outlined" 
                        Color="Color.Primary" 
                        Size="Size.Medium" 
                        /> 
                </MudTooltip>
            </MudText>             
            <MudButton Variant="Variant.Filled"
                           Color="Color.Primary"
                           Size="Size.Large"
                           ButtonType="ButtonType.Button">
                           Change password
            </MudButton>
        </MudPaper>        
    </MudItem>    
</MudGrid>

@code {

    private ProfileModel profileModel = new ProfileModel();

    private string username;
    private string email;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            profileModel = await profileService.GetProfile();
            username = profileModel.Name;
            email = profileModel.Email;
            
        }
        catch(Exception ex)
        {
            throw new Exception(ex.Message);
        }
    }        
}
